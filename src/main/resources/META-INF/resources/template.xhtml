<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Siamois</title>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
    <h:outputScript library="js" name="jquery-3.7.1.js"/>
    <h:outputScript library="js" name="bootstrap.bundle.min.js"/>
    <h:outputStylesheet library="css" name="styles.css"/>
    <h:outputStylesheet library="css" name="jquery-ui.css"/>
    <h:outputScript library="js" name="jquery-ui.js"/>

    <script type="text/javascript">
        window.csrfTokenName = "{{ craft.config.csrfTokenName }}";
        window.csrfTokenValue = "{{ craft.request.csrfTokenValue }}";
    </script>
</h:head>

<!-- Metadata will be inserted here (JSF1103: The metadata facet must be a direct child of the view) -->
<ui:insert name="metadata"/>

<h:body>
    <!-- Main Layout -->
    <div class="layout-container no-gutters">
        <div class="row g-0">
            <div class="col-md-1">

                <div class="left-panel shadow">
                    <div class="app-name">SIAMOIS</div>
                    <h:button value='${langBean.msg("home.save.spatialunit")}' outcome="/pages/create/spatialUnit.xhtml"/>

                    <!--                        <p:menu>
                                                <p:submenu styleClass="icon-only-menu" label="">
                                                    <p:menuitem value="" outcome="/pages/home/home" icon="pi pi-home"/>
                                                    &lt;!&ndash; Add more menu items as needed &ndash;&gt;
                                                </p:submenu>
                                            </p:menu>-->
                </div>
            </div>
            <div class="col">
                <!-- Top Menu Bar -->
                <div class="top-bar shadow">
                    <p:menubar>
                        <f:facet name="start">
                            <nav>
                                <form action="${navBean.logoutPath()}" method="post">
                                    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
                                    <button type="submit" class="btn btn-danger">${langBean.msg("nav.logout")}</button>
                                </form>
                                <h:button value='${langBean.msg("nav.fieldconfig")}'
                                          outcome="/pages/field/fieldConfiguration.xhtml" styleClass="btn btn-primary"/>

                                <h:button rendered="#{navBean.userIs('ADMIN')}"
                                          value='${langBean.msg("nav.create.manager")}'
                                          outcome="/pages/admin/manager.xhtml" styleClass="btn btn-danger"/>

                                <h:button rendered="#{navBean.userIs('ADMIN')}"
                                          value='${langBean.msg("nav.create.team")}'
                                          outcome="/pages/admin/team.xhtml" styleClass="btn btn-danger"/>

                                <h:button rendered="#{navBean.userIsAny('TEAM_MANAGER', 'ADMIN')}"
                                          value="GÃ©rer les utilisateurs"
                                          outcome="/pages/manager/users.xhtml" styleClass="btn btn btn-warning"/>

                                <h:form>
                                    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
                                    <p:selectOneMenu id="teamSelection"
                                                     value="#{navBean.selectedTeam}"
                                                     rendered="#{navBean.teams.size() > 1}"
                                                     converter="#{navBean.converter}">
                                        <f:selectItems
                                                value="#{navBean.teams}"
                                                itemLabel="#{team.name}"
                                                var="team"/>
                                        <p:ajax listener="#{navBean.onTeamChange()}" update="main"/>
                                    </p:selectOneMenu>
                                </h:form>

                            </nav>
                        </f:facet>
                        <p:divider layout="vertical"/>
                    </p:menubar>
                </div>

                    <h:form>
                        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
                        <p:breadCrumb style="border:none;background:transparent;border-radius:0;">
                            <p:menuitem value="Home" outcome="/pages/home/home"/>
                        </p:breadCrumb>
                    </h:form>

                <p:card id="main" class="shadow" style="margin:1em;">
                    <ui:insert name="content">
                        <!-- Content will be inserted here -->
                    </ui:insert>
                </p:card>
            </div>

        </div>
    </div>

</h:body>
</html>
