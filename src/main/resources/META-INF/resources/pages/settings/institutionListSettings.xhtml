<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:comp="http://java.sun.com/jsf/composite/pages/settings/components"
                xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core">
>
    <ui:define name="head">
        <link rel="stylesheet" href="#{redirectBean.redirectUrlToResource('settings.css', 'css')}"/>
    </ui:define>

    <ui:define name="content">
        <main>
            <comp:datatable
                    formId="institutionManager"
                    title="Organisations"
                    filterAction="#{institutionListSettingsBean.onFilterType()}"
                    addAction="#{institutionListSettingsBean.createOrganisation()}"
                    searchInputTextValue="#{institutionListSettingsBean.filterText}"
                    searchInputPlaceholder="Rechercher une organisation"
                    isOrganisationManager="#{institutionListSettingsBean.userIsSuperadmin()}"
            >
                <p:dataTable
                        id="organisationArray"
                        value="#{institutionListSettingsBean.filteredInstitutions}"
                        var="organisation"
                        sortMode="single"
                        widgetVar="institutionManagerDatatable"
                        rowKey="#{organisation.id}"
                >
                    <p:column headerText="Organisation active">
                        <p:toggleSwitch value="#{institutionListSettingsBean.toggleSwitchState[organisation.id]}">
                            <p:ajax event="change" listener="#{institutionListSettingsBean.changeCurrentInstitution(organisation)}" update="@form"/>
                        </p:toggleSwitch>
                    </p:column>
                    <p:column headerText="Nom de l'organisation">
                        <p:outputLabel value="#{organisation.name}"/>
                    </p:column>
                    <p:column headerText="Membres">
                        <p:outputLabel value="12"/>
                    </p:column>
                    <p:column headerText="Enregistrements">
                        <p:outputLabel value="12"/>
                    </p:column>
                    <p:column headerText="Date de crÃ©ation" >
                        <p:outputLabel value="#{institutionListSettingsBean.displayDate(organisation.creationDate)}"/>
                    </p:column>
                    <p:column>
                        <p:menuButton buttonStyleClass="dt-button" icon="bi bi-three-dots">
                            <p:menuitem value="Modifier" icon="bi bi-arrow-clockwise"/>
                            <p:menuitem value="Supprimer" icon="bi bi-x"/>
                        </p:menuButton>
                    </p:column>
                </p:dataTable>
            </comp:datatable>
        </main>
    </ui:define>

</ui:composition>