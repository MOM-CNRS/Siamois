<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
             xmlns:sharedInput="http://xmlns.jcp.org/jsf/composite/pages/shared/input"
             xmlns:p="http://primefaces.org/ui"
             xmlns:siaInplace="http://xmlns.jcp.org/jsf/composite/pages/shared/inplace"
             xmlns:c="http://java.sun.com/jsp/jstl/core"
>

   <!--@elvariable id="bean" type="fr.siamois.ui.bean.panel.models.panel.single.AbstractSingleEntityPanel"-->
   <!--@elvariable id="customFormPanel" type="fr.siamois.domain.models.form.CustomFormPanel" -->
   <!--@elvariable id="readOnly" type="java.lang.Boolean" -->
   <!--@elvariable id="prefix" type="String" -->
   <!--@elvariable id="updateTargetsOnBlur" type="String" -->
   <!--@elvariable id="statusIndex" type="Object" -->


   <p:panelGrid id="customFormPanelGrid-#{prefix}-#{statusIndex}"
                layout="grid"
   >
      <c:forEach items="#{customFormPanel.rows}" var="row" varStatus="rowStatus">
         <p:row>

            <c:forEach items="#{row.columns}" var="col" varStatus="colStatus">


               <p:column styleClass="ui-g-12 ui-md-6 ui-lg-4">
                  <!-- Text -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldText'}">

                     <siaInplace:text
                             panelModel="#{bean}"
                             field="#{col.field}"
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             answer="#{bean.formResponse.answers.get(col.field)}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                     >

                     </siaInplace:text>
                  </sharedInput:panelField>

                  <!-- DateTime -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldDateTime'}">

                     <siaInplace:datePicker
                             panelModel="#{bean}"
                             field="#{col.field}"
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             answer="#{bean.formResponse.answers.get(col.field)}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                     >

                     </siaInplace:datePicker>
                  </sharedInput:panelField>

                  <!-- Select one from field code -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}" isTheso="true"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectOneFromFieldCode'}">
                     <siaInplace:concept
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

                  <!-- Select one concept from field parent concept children -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}" isTheso="true"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectOneConceptFromChildrenOfConcept'}">
                     <siaInplace:childConcept
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

                  <!-- Select one action -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectOneActionUnit'}">
                     <siaInplace:action
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

                  <!-- Select one spatial -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectOneSpatialUnit'}">
                     <siaInplace:spatial
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

                  <!-- Select one from person -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectOnePerson'}">
                     <siaInplace:person
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

                  <!-- Select multiple from person -->
                  <sharedInput:panelField title="#{spatialUnitFieldBean.resolveCustomFieldLabel(col.field)}"
                                          rendered="#{col.field['class'].simpleName eq 'CustomFieldSelectMultiplePerson'}">
                     <siaInplace:person
                             hasBeenModified="#{bean.formResponse.answers.get(col.field).hasBeenModified}"
                             field="#{col.field}"
                             multiple="true"
                             mode="#{col.readOnly ? 'output' : flowBean.getInPlaceFieldMode()}"
                             panelModel="#{bean}"
                             updateTargetsOnBlur="#{updateTargetsOnBlur}"
                             answer="#{bean.formResponse.answers.get(col.field)}"/>
                  </sharedInput:panelField>

               </p:column>


            </c:forEach>
         </p:row>
      </c:forEach>
   </p:panelGrid>

</ui:fragment>