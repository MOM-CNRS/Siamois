<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:p="http://primefaces.org/ui"
             xmlns:f="http://java.sun.com/jsf/core"

>
    <h:form id="newUnitForm">
        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        <p:dialog widgetVar="newUnitDiag" id="newUnitDiag" showEffect="fade" closeOnEscape="true"
                  fitViewport="true"
                  width="60vw"
                  minWidth="400"
                  maxWidth="90vw"
                  style="max-height:900px;"
                  appendToBody="true" modal="true"
                  styleClass="sia-new-unit-dialog ui-panel siamois-panel #{genericNewUnitDialogBean.handler.styleClassName()}">

            <f:facet name="header">
                    <p:outputPanel style="display: flex;gap: 0.5em; align-items: center;
                            float:left;color: var(--main-color);">
                        <i class="#{genericNewUnitDialogBean.handler.getIcon()}"/>
                        <span style="padding-right:0.5em;">#{genericNewUnitDialogBean.handler.getTitle(genericNewUnitDialogBean.newUnitContext)}</span>
                    </p:outputPanel>
            </f:facet>


                <p:outputPanel id="newUnitFormContent">
                    <ui:include src="/pages/shared/form/customForm.xhtml">
                        <ui:param name="panelModel" value="#{genericNewUnitDialogBean}"/>
                        <ui:param name="layout" value="#{genericNewUnitDialogBean.detailsForm.layout}"/>
                        <ui:param name="readOnly" value="#{false}"/>
                        <ui:param name="prefix" value="newUnitForm"/>
                        <ui:param name="root" value="newUnitForm"/>
                        <ui:param name="panelId" value="newUnitForm:newUnitFormContent"/>
                    </ui:include>
                </p:outputPanel>



            <!-- Save/Cancel Toolbar -->
            <f:facet name="footer">
                <div>
                    <p:toolbar class="panel-footer">
                        <p:toolbarGroup align="right">
                            <p:commandLink value='#{langBean.msg("common.action.cancel")}'
                                           oncomplete="PF('newUnitDiag').hide()"
                                           immediate="true"
                                           style="margin-right: 1rem">
                            </p:commandLink>
                            <!-- resetValues=true in the commands resets the datatables value. With false it was causing issues -->
                            <p:commandButton id="createButton" value='#{langBean.msg("common.action.create")}'
                                             action="#{genericNewUnitDialogBean.create()}"
                                             resetValues="true"
                                             update="newUnitFormContent templateFormCC:templateForm:templateGrowl #{genericNewUnitDialogBean.newUnitContext.updateOnCreate}"
                                             style="margin-right: 1rem">
                            </p:commandButton>
                        </p:toolbarGroup>
                    </p:toolbar>
                </div>
            </f:facet>


        </p:dialog>
    </h:form>
</ui:fragment>