<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
             xmlns:p="http://primefaces.org/ui"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
>

    <!--@elvariable id="panelIndex" type="Integer"-->
    <!--@elvariable id="panelModel" type="fr.siamois.ui.bean.panel.models.panel.single.AbstractSingleEntity"-->

    <!-- Content -->
    <p:staticMessage severity="error" summary="Error" closable="false"
                     detail="#{panelModel.errorMessage}"
                     rendered="#{not empty panelModel.errorMessage}"/>
    <h:panelGroup id="unitContentPanel" rendered="#{panelModel.unit != null}">


        <h:form id="singlePanelUnitForm-#{panelIndex}">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>

            <!-- Tabs -->
            <ui:include src="#{panelModel.getTabView()}" />

            <!-- Save/Cancel Toolbar -->
            <p:toolbar class="panel-footer">
                <p:toolbarGroup align="left">
                    <div style="flex-direction: row; display: flex; gap: 1em; align-items: center;">
                        <div style="display: flex; flex-direction: column">
                            <div style="display: flex; flex-direction: row; gap:1em">
                                <small>
                                    <i>
                                        Créé le
                                        <span class="panel-history-colored-span">
                                      #{panelModel.formatUtcDateTime(panelModel.unit.creationTime, false)}
                                    </span>
                                        par
                                        <span class="panel-history-colored-span">
                                      #{panelModel.unit.createdBy.displayName()}
                                    </span>
                                    </i>
                                </small>
                                <small>
                                    <i>
                                        Modifié le
                                        <span class="panel-history-colored-span">
                                      #{panelModel.lastUpdateDate()}
                                    </span>
                                        par
                                        <span class="panel-history-colored-span">
                                      #{panelModel.lastUpdater()}
                                    </span>
                                    </i>
                                </small>
                                <h:panelGroup rendered="#{panelModel.unit.validated}">
                                    <small>
                                        <i>
                                            Validé le
                                            <span class="panel-history-colored-span">
                                      #{panelModel.formatUtcDateTime(panelModel.unit.validatedAt, false)}
                                    </span>
                                            par
                                            <span class="panel-history-colored-span">
                                      #{panelModel.unit.createdBy.displayName()}
                                    </span>
                                        </i>
                                    </small>
                                </h:panelGroup>
                            </div>

                            <small>
                                <i>
                                    Contributeurs:
                                    <span class="panel-history-colored-span">
                                      #{panelModel.allUpdaters()}
                                    </span>
                                </i>
                            </small>

                        </div>
                        <div>
                            <p:commandButton disabled="true" icon="bi bi-clock-history">

                            </p:commandButton>
                        </div>
                    </div>

                </p:toolbarGroup>
                <p:toolbarGroup align="right" rendered="#{flowBean.isWriteMode}">
                    <p:commandLink value='#{langBean.msg("common.action.cancel")}'
                                   update="panel-#{panelIndex}"
                                   id="cancelButton"
                                   action="#{panelModel.cancelChanges()}"

                                   style="margin-right: 1rem">
                    </p:commandLink>
                    <p:commandButton id="saveButton" value='#{langBean.msg("common.action.save")}'
                                     update="panel-#{panelIndex}"

                                     action="#{panelModel.saveAction(false)}"
                                     style="margin-right: 1rem">
                    </p:commandButton>
                </p:toolbarGroup>
            </p:toolbar>
        </h:form>

    </h:panelGroup>


</ui:fragment>